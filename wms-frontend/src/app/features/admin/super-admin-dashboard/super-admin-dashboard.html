<div class="space-y-6">

  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
    <div>
      <h2 class="text-2xl font-bold text-slate-800 tracking-tight">Gestión de Clientes SaaS</h2>
      <p class="text-slate-500 text-sm">Administra las empresas, suscripciones y accesos maestros.</p>
    </div>
    
    <button (click)="showForm = !showForm" 
            class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-lg shadow-md hover:shadow-lg transition-all flex items-center gap-2 font-medium">
      <i class="bi" [ngClass]="showForm ? 'bi-x-lg' : 'bi-plus-lg'"></i>
      {{ showForm ? 'Cancelar Alta' : 'Nueva Empresa' }}
    </button>
  </div>

  <div *ngIf="showForm" class="bg-white border border-indigo-100 rounded-xl shadow-lg overflow-hidden animate-fade-in-down">
    <div class="bg-indigo-50 px-6 py-4 border-b border-indigo-100 flex justify-between items-center">
      <h3 class="text-indigo-800 font-bold flex items-center gap-2">
        <i class="bi bi-rocket-takeoff"></i> Onboarding de Nuevo Cliente
      </h3>
    </div>
    
    <div class="p-6 md:p-8">
      <form (ngSubmit)="createTenant()" class="space-y-6">
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-4">
            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider border-b pb-1">Datos de la Empresa</h4>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1">Nombre Comercial</label>
              <input type="text" [(ngModel)]="newData.companyName" name="cname" placeholder="Ej: Pepsi Co." required
                     class="w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3 text-sm border">
            </div>
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1">Tenant ID (Único)</label>
              <input type="text" [(ngModel)]="newData.companyId" name="cid" placeholder="Ej: PEPSI" required uppercase
                     class="w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3 text-sm border font-mono bg-slate-50 uppercase">
              <p class="text-xs text-slate-400 mt-1">Este ID se usará internamente para separar los datos.</p>
            </div>
          </div>

          <div class="space-y-4">
             <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider border-b pb-1">Primer Administrador</h4>
             <div>
              <label class="block text-sm font-medium text-slate-700 mb-1">Email de Contacto</label>
              <input type="email" [(ngModel)]="newData.adminEmail" name="aemail" required
                     class="w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3 text-sm border">
             </div>
             <div class="grid grid-cols-2 gap-4">
               <div>
                 <label class="block text-sm font-medium text-slate-700 mb-1">Usuario</label>
                 <input type="text" [(ngModel)]="newData.adminUsername" name="ausr" required
                        class="w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3 text-sm border">
               </div>
               <div>
                 <label class="block text-sm font-medium text-slate-700 mb-1">Contraseña</label>
                 <input type="password" [(ngModel)]="newData.adminPassword" name="apass" required
                        class="w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3 text-sm border">
               </div>
             </div>
          </div>
        </div>

        <div class="flex justify-end pt-4 border-t border-slate-100">
          <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors">
            Crear y Provisionar
          </button>
        </div>
      </form>
    </div>
  </div>

  <div class="bg-white shadow-md rounded-lg overflow-hidden border border-slate-200">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-slate-200">
        <thead class="bg-slate-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">ID (Tenant)</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Empresa</th>
            <th class="px-6 py-3 text-center text-xs font-medium text-slate-500 uppercase tracking-wider">Estado</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Contacto</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Alta</th>
            <th class="px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider">Acciones</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-slate-200">
          <tr *ngFor="let t of tenants" class="hover:bg-slate-50 transition-colors">
            
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="font-mono font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded text-xs border border-indigo-100">
                {{ t.id }}
              </span>
            </td>

            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-bold text-slate-800">{{ t.name }}</div>
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-center">
              <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full"
                    [ngClass]="{
                      'bg-emerald-100 text-emerald-800 border border-emerald-200': t.status === 'ACTIVE',
                      'bg-amber-100 text-amber-800 border border-amber-200': t.status === 'SUSPENDED',
                      'bg-blue-100 text-blue-800 border border-blue-200': t.status === 'TRIAL'
                    }">
                <span class="w-2 h-2 rounded-full mr-1.5 mt-1" 
                      [ngClass]="{'bg-emerald-500': t.status==='ACTIVE', 'bg-amber-500': t.status==='SUSPENDED'}"></span>
                {{ t.status }}
              </span>
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">
              <div class="flex items-center gap-2">
                <i class="bi bi-envelope text-slate-400"></i>
                {{ t.contactEmail }}
              </div>
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-xs text-slate-500">
              {{ t.createdAt | date:'mediumDate' }}
            </td>

            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              
              <button (click)="toggleStatus(t)" class="mr-3 transition-colors"
                      [ngClass]="t.status === 'ACTIVE' ? 'text-amber-500 hover:text-amber-700' : 'text-emerald-500 hover:text-emerald-700'"
                      title="{{ t.status === 'ACTIVE' ? 'Suspender Servicio' : 'Reactivar Servicio' }}">
                <i class="bi" [ngClass]="t.status === 'ACTIVE' ? 'bi-pause-circle-fill' : 'bi-play-circle-fill'"></i>
              </button>

              <button (click)="deleteTenant(t)" class="text-slate-400 hover:text-rose-600 transition-colors" title="Eliminar Cliente">
                <i class="bi bi-trash3-fill"></i>
              </button>
            </td>

          </tr>
          
          <tr *ngIf="tenants.length === 0">
            <td colspan="6" class="px-6 py-12 text-center text-slate-400">
              <i class="bi bi-building-dash text-4xl block mb-2 opacity-50"></i>
              No hay empresas registradas. Comienza el onboarding.
            </td>
          </tr>

        </tbody>
      </table>
    </div>
  </div>

</div>